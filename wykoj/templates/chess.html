<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--
        Why make a completely new page instead of using layout.html?
        PgnViewerJS uses a different version of Font Awesome than WYKOJ,
        hence making WYKOJ's own Font Awesome icons unable to show.
    -->

    {# Load favicon, CSS (Bootstrap + custom) and PgnViewerJS #}
    <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.min.css') }}">
    <script src="{{ url_for('static', filename='lib/pgnv.js') }}"></script>

    <title>{{ title }} - WYKOJ</title>
</head>
<body">
<header>
    <nav class="fixed-top">
        <ul class="clearfix">
            <a href="{{ url_for('main.home') }}">
                <li class="site-brand no-hover-fx align-left">WYKOJ</li>
            </a>
        </ul>
    </nav>
</header>

<main role="main">
    <div class="container-fluid mb-3">
        {# Flashed messages #}
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endwith %}

        <div class="row">
            <div class="col">
                <h2 class="border-bottom pb-1">WYK Blunder Team Game Display</h2>
            </div>
        </div>
        <div class="row">
            {% for game in games %}
                <div class="col-xl-6 col-md-12 mt-3">
                    <h3>{{ game.game_format }}</h3>
                    <h4>
                        <a href="{{ url_for('main.user_page',
                                            username=cu_to_user[game.white_username.lower()].username) }}">
                            {{ game.white_username }}</a>
                        ({{ game.white_rating }})
                        vs
                        <a href="{{ url_for('main.user_page',
                                            username=cu_to_user[game.black_username.lower()].username) }}">
                            {{ game.black_username }}</a>
                        ({{ game.black_rating }})
                    </h4>
                    <h5>{{ game.termination }}</h5>
                    <h5><a href="{{ game.url }}" target="_blank">{{ game.time | datetime }}</a></h5>
                    <div id="board{{ game.game_id }}" class="mt-2"></div>
                </div>
            {% endfor %}

            <script>
                {% for game in games %}
                    PGNV.pgnView('board{{ game.game_id }}', {
                        pgn: `{{ game.pgn | safe }}`,
                        showCoords: false,
                        pieceStyle: "wikipedia"
                    });
                {% endfor %}
            </script>
        </div>
    </div>
</main>

{# Load Bootstrap dependencies and custom JS #}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
</script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous">
</script>
<script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>
